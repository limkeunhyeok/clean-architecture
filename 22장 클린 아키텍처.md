# Clean Architecture

## 05 아키텍처

### 22장 클린 아키텍처

> 다양한 아키텍처의 공통적인 목표는 관심사의 분리이다.

- 계층으로 분리하여 관심사를 분리한다.
- 각 아키텍처는 최소한 업무 규칙을 위한 계층 하나와, 사용자와 시스템 인터페이스를 위한 또 다른 계층 하나를 반드시 포함한다.

> 아키텍처들은 모두 시스템이 다음과 같은 특징을 지니도록 만든다.

- 프레임워크 독립성
  - 아키텍처는 프레임워크의 존재 여부에 의존하지 않는다.
  - 이를 통해 프레임워크가 지닌 제약사항안으로 시스템을 욱여 넣는게 아닌 프레임워크를 도구로 사용할 수 있다.
- 테스트 용이성
  - 업무 규칙은 UI, 데이터베이스, 웹 서버, 외부 요소 없이 테스트할 수 있다.
- UI 독립성
  - 시스템의 나머지 부분을 변경하지 않고도 UI를 쉽게 변경할 수 있다.
  - 예를 들어 업무 규칙을 변경하지 않고도 웹 UI를 콘솔 UI로 대체할 수 있다.
- 데이터베이스 독립성
  - 오라클이나 MS SQL서버를 몽고DB(MongoDB), 빅테이블(BigTable), 카우치DB(CauchDB) 등으로 교체할 수 있다.
  - 업무 규칙은 데이터베이스에 결합되지 않는다.
- 모든 외부 에이전시에 대한 독립성
  - 실제로 업무 규칙은 외부 세계와의 인터페이스에 대해 전혀 알지 못한다.

![클린 아키텍처](https://velog.velcdn.com/images/hellojihyoung/post/3702c8ec-2093-4e1f-95b7-74d0638639d8/image.png)

#### 의존성 규칙

- 안으로 향할수록 고수준의 소프트웨어가 된다.
- 바깥쪽 원은 메커니즘이고, 안쪽 원은 정책이다.
- 클린 아키텍처가 동작하도록 하는 가장 중요한 규칙은 의존성 규칙(Dependency Rule)이다.

> 소스 코드 의존성은 반드시 안쪽으로, 고수준의 정책을 향해야 한다.

- 내부의 원에 속한 요소는 외부의 원에 속한 어떤 것도 알지 못한다.
  - 함수, 클래스, 변수, 소프트웨어 엔티티로 명명되는 모든 것을 언급해선 안된다.
- 외부의 원에 선언된 데이터 형식도 내부의 원에서 절대로 사용해서는 안 된다.

##### 엔티티

- 엔티티는 전사적인 핵심 업무 규칙을 캡슐화한다.
- 전사적이지 않고 단순한 애플리케이션을 작성한다면 엔티티는 해당 애플리케이션의 업무 객체가 된다.
- 운영 관점에서 특정 애플리케이션에 무언가 변경이 필요하더라도 엔티티 계층에는 절대로 영향을 주어서는 안 된다.

##### 유스케이스

- 유스케이스 계층의 소프트웨어는 애플리케이션에 특화된 업무 규칙을 포함한다.
- 유스케이스 계층의 소프트웨어는 애플리케이션에 특화된 업무 규칙을 포함하며 시스템의 모든 유스케이스를 캡슐화하고 구현한다.
- 엔티티로 들어오고 나가는 데이터 흐름을 조정하며, 엔티티가 자신의 핵심 업무 규칙을 사용해서 유스케이스의 목적을 달성하도록 이끈다.
- 이 계층에서 발생한 변경이 엔티티에 영향을 주면 안 되며, 외부 요소에서 발생한 변경이 이 계층에 영향을 주면 안된다.
  - 관심사로부터 격리되어있다.
  - 하지만 운영 관점에서 애플리케이션이 변경된다면 유스케이스가 영향을 받고, 따라서 이 계층의 소프트웨어에도 영향을 줄 것이다.
