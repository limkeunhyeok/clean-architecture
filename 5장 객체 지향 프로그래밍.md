# Clean Architecture

## 02 벽돌부터 시작하기: 프로그래밍 패러다임

### 5장 객체 지향 프로그래밍

#### 캡슐화?

- 데이터와 함수를 쉽고 효과적으로 캡슐화하는 방법을 객체 지향 언어가 제공한다.
- 데이터와 함수가 응집력 있게 구성된 집단을 서로 구분 짓는 선을 그을 수 있다.
- 구분선 바깥에서 데이터는 은닉되고, 일부 함수만이 외부에 노출된다.
- 객체 지향이 아닌 언어에서도 캡슐화는 충분히 가능하다.
- 객체 지향 프로그래밍은 프로그래머가 충분히 올바르게 행동함으로써 캡슐화된 데이터를 우회해서 사용하지 않을 것이라는 믿음을 기반으로 한다.
  - 실제로 많은 객체 지향 언어가 캡슐화를 강제하지 않는다.

#### 상속?

- 상속은 단순히 어떤 변수와 함수를 하나의 유효 범위로 묶어서 재정의하는 일이다.
- 객체 지향 이전에도 상속이 비슷하게 있었으나, 다중 상속 구현에는 어려움이 있었다.
  - 객체 지향 언어가 완전히 새로운 개념을 만들지는 못했지만, 편의성을 높였다.

#### 다형성?

- 객체 지향 언어 이전에도 다형성은 표현 가능했다.
  - 다형성은 함수를 가리키는 포인터를 응용하는 것이다.
- 객체 지향 언어는 다형성을 새롭게 만들어 제공하진 않지만, 다형성을 좀 더 안전하고 더욱 편리하게 사용할 수 있게 해준다.
- 포인터를 안전하게 사용하려면 관례를 따라야 하는데 객체 지향 언어는 이러한 관례를 없애줌으로써, 실수할 위험이 없다.
- 객체 지향 언어는 제어흐름을 간접적으로 전환하는 규칙을 부과한다.

##### 다형성이 가진 힘

- 플러그인 아키텍처는 독립성을 지원하며, 객체 지향의 등장으로 어디서든 플러그인 아키텍처 적용 가능하다.

##### 의존성 역전

- 다형성을 적용하는 방법이 등장하기 전 소프트웨어 코드의 의존성 방향은 제어흐름(flow of control)을 따랐다.

![다형성 제어 흐름](https://media.vlpt.us/images/hellojihyoung/post/be432966-8fe4-4199-bf8f-179cbdec70ad/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-04-03%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%207.33.55.png)

- 다형성을 추가하면 아래 그림처럼 변한다.

![다형성 적용](https://media.vlpt.us/images/hellojihyoung/post/63b38c2b-8d7a-4fbd-b6d1-ec18d4eb7136/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-04-03%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%207.36.20.png)

- HL1 모듈은 ML1 모듈의 F() 함수를 호출한다.
- 소스 코드에서는 HL1 모듈은 인터페이스를 통해 F()함수를 호출한다.
  - ML1과 I 인터페이스 사이의 소스 코드 의존성(상속 관계)이 제어흐름과는 반대이다. 이를 의존성 역전(dependency inversion)이라고 한다.
- 이러한 접근법을 사용한다면, 객체지향 언어로 개발된 시스템을 다루는 소프트웨어 아키텍트는 시스템의 소스 코드 의존성 전부에 대해 방향을 결정할 수 있는 절대적인 권한을 갖는다.

![의존성 역전](https://media.vlpt.us/images/hellojihyoung/post/90722b9b-ba3a-40ca-bb0b-be94c27aeac4/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-04-03%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%207.41.11.png)

- 의존성 역전을 통해 위의 그림처럼 UI와 데이터베이스가 업무 규칙의 플러그인이 되게끔 할 수 있다.
  - 배포 독립성 : 업무 규칙을 UI와 데이터베이스와는 독립적으로 배포할 수 있다.
  - 개발 독립성 : 시스템의 모듈을 독립적으로 배포할 수 있게 되면, 서로 다른 팀에서 각 모듈을 독립적으로 개발할 수 있다.

#### 결론

- 객체 지향이란 아키텍처 관점에서 다형성을 이용하여 전체 시스템의 모든 소스 코드 의존성에 대한 절대적인 제어 권한을 획득할 수 있는 능력이다.
- 객체 지향을 사용하면 아키텍처는 플러그인 아키텍처를 구성할 수 있고, 고수준의 정책을 포함하는 모듈은 저수준의 세부사항을 포함하는 모듈에 대해 독립성을 보장할 수 있다.
- 저수준의 세부사항은 중요도가 낮은 플러그인 모듈로 만들 수 있고, 고수준의 정책을 포함하는 모듈과는 독립적으로 개발하고 배포할 수 있다.
