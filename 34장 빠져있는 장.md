# Clean Architecture

## 06 세부사항

### 34장 빠져있는 장

#### 계층 기반 패키지

- 가장 단순한 첫번째 설계방식이고 전통적인 수평 계층형 아키텍처이다.
- 계층 기반 패키지란 기술적인 관점에서 해당 코드가 하는 일을 기반해 그 코드를 분할한다. 
- 계층은 업무규칙으로 유사한 종류의 것들을 묶는 도구로 사용된다. 
- 엄격한 계층형 아키텍처 경우 계층은 반드시 바로 아래 계층에만 의존해야 한다.

![계층 기반 패키지](https://wikidocs.net/images/page/167395/34.1.png)

- OrdersController: 웹기반 요청처리
- OrdersService: 주문 관련 업무규칙 정의
- OrdersServiceImpl: OrderService구현체
- OrdersRepository: 저장 정보에 접근하는 방법정의 인터페이스
- JdbcOrderRepository: OrdersRepository 구현체

##### 계층 기반 아키텍처 특징

- 처음 시작하기에 적합한 아키텍처이다.
- 엄청난 복잡함을 겪지 않고 무언가를 동작시켜주는 아주 빠른 방법이다.
- 소프트웨어가 커지고 복잡해 지면 모든 코드를 담기 부족하다고 깨닫게 되고, 더 잘게 모듈화 할지 고민하게 된다.
- 업무 도메인에 대해 아무것도 말해주지 않는다.

#### 기능 기반 패키지

- 기능 기반 패키지란 서로 연관된 기능, 도메인 개념, Aggregate Root(데이터 변경의 단위로 연관객체의 묶음)에 기반하여 수직의 얇은 조각으로 코드를 나누는 방식이다.
- 모든 타입이 하나의 자바 패키지에 속하고, 패키지 이름은 그안에 담긴 개념을 반영해 짓는다.

![기능 기반 패키지](https://wikidocs.net/images/page/167395/34.2.png)

##### 기능 기반 패키지 특징

- 코드 상위 수준 구조가 업무 도메인에 대해 알려주게 된다.
- 주문 조회하기 유즈케이스 변경시 변경할 코드를 모두 찾는 작업이 쉬워진다.
  - 변경 해야할 코드가 모두 한 패키지에 담겨 있기 때문이다.
- 위 두가지 수평(계층 기반 패키지), 수직적 계층화(기능 기반 패키지) 지는 개발 차선책이다.

#### 포트와 어댑터

- 포트와 어댑터란 육각형 아키텍처로 경계, 컨트롤러, 엔티티 방식으로 접근한다.
  - 업무/도메인 코드와, 프레임워크나 데이터베이스 같은 기술적 세부구현과 독립적이며 분리된 아키텍처를 만들기 위한 구조이다.
- 내부(도메인)과 외부(인프라)로 구성된다.
- 내부 영역은 도메인 개념을 모두포함하나 외부는 UI, 데이터베이스, 서드파티 통합과 상호작용한다.
- 주요 규칙은 외부가 내부에 의존하며, 절대 그 반대로는 안 된다.

![포트와 어댑터](https://wikidocs.net/images/page/167395/34.4.png)

- OrdersRepository가 Orders라는 간단한 이름으로 바뀌었다.
- 도메인 주도 설계에서 ‘내부'에 존재하는 모든것의 이름은 반드시 ‘유비쿼터스 도메인 언어' 관점에서 기술하라고 한다.
  - 즉 도메인에 대해 논할때 우리는 '주문’에 대해 말하는 것이지 ‘주문 레파지터리'에 대해 말하는 것이 아니라는 것이다.
